{% extends "base.html" %}

{% block title %}{{ plan.title }} | GroupTrotter{% endblock %}

{% block content %}

<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />

{{ plan.id }}

<div id="plan-title"></div>
<div id="event-list"></div>

<a id="btn-add-event" class="btn btn-success">Add Button</a>

<script>

$('#btn-add-event').click(function() {
    var events_ref = new Firebase('https://grouptrotter.firebaseio.com/plans/{{ plan.id }}/events/');
    events_ref.push({header: 'test'});
});

$(document).ready(function(){
    $('#event-list').sortable({ axis: "x" });

  var plan_ref = new Firebase('https://grouptrotter.firebaseio.com/plans/{{ plan.id }}');
  plan_ref.on('value', function(snapshot) {
    if(snapshot.val() === null) {
      alert('Plan does not exist!');
    } else {
      $('#plan-title').html(snapshot.val().title);
      var events = snapshot.val().events;
      $('#event-list').html('');
      for(var key in events) {
        var datum = events[key];
        $('#event-list').append(datum.header + Math.random() + '<br />');
      }
    }
  });
});

</script>

{% endblock %}

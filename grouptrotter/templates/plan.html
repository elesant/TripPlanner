{% extends "base.html" %}

{% block title %}{{ plan.title }} | GroupTrotter{% endblock %}

{% block content %}

<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />

{{ plan.id }}

<div id="plan-title"></div>
<div id="event-list"></div>

<input id="input-event-header" type="text" />
<a id="btn-add-event" class="btn btn-success">Add Button</a>

<script>

var plan_ref = new Firebase('https://grouptrotter.firebaseio.com/plans/{{ plan.id }}');

$(document).ready(function(){
  var events_ref = plan_ref.child('events');

  $('#btn-add-event').click(function() {
    var header = $('#input-event-header').val();
    events_arr = events_ref.push({header: header});
    events_ref.set(events_arr);
  });

  var dragEnd = function(e, ui) {
    var start = ui.item.data('start'),
          end = ui.item.index();

  };

  $('#event-list').sortable({
    start: function (){},
    end: dragEnd
  });
  $('#event-list').disableSelection();

    plan_ref.on('value', function(snapshot) {
    if(snapshot.val() === null) {
      alert('Plan does not exist!');
    } else {
      $('#plan-title').html(snapshot.val().title);
      var events = snapshot.val().events;
      $('#event-list').html('');
      for(var key in events) {
        var datum = events[key];
        $('#event-list').append('<div class="well">' + datum.header + '</div>');
      }
    }
  });
});

</script>

{% endblock %}
